
b1;TRANSACTION BEGINS, ID:1 TS:1 STATE=ACTIVE
r1(Y);Y IS READ LOCKED BY  T1
r1(Z);Z IS READ LOCKED BY  T1
b2;TRANSACTION BEGINS, ID:2 TS:2 STATE=ACTIVE
r2(Y);SHARED LOCK ON Y BY TRANSACTION [1, 2]
b3;TRANSACTION BEGINS, ID:3 TS:3 STATE=ACTIVE
r3(Y);SHARED LOCK ON Y BY TRANSACTION [1, 2, 3]
w1(Z);READ LOCK ON Z IS UPGRADED TO WRITE LOCK
w3(Y);TRANSACTION3 IS ABORTED,CHECK AND RELEASE IF IT HOLDS ANY LOCKS
e1;TRANSACTION T1 IS COMMITTED
e3;TRANSACTION T3 IS ABORTED
w2(Y);READ LOCK ON Y IS UPGRADED TO WRITE LOCK
r2(X);X IS READ LOCKED BY  T2
w2(X);READ LOCK ON X IS UPGRADED TO WRITE LOCK
e2;TRANSACTION T2 IS COMMITTED