
b1;TRANSACTION BEGINS, ID:1 TS:1 STATE=ACTIVE
r1(Y);Y IS READ LOCKED BY  T1
w1(Y);READ LOCK ON Y IS UPGRADED TO WRITE LOCK
r1(Z);Z IS READ LOCKED BY  T1
b2;TRANSACTION BEGINS, ID:2 TS:2 STATE=ACTIVE
r2(Y);TRANSACTION2 IS ABORTED,CHECK AND RELEASE IF IT HOLDS ANY LOCKS
b3;TRANSACTION BEGINS, ID:3 TS:3 STATE=ACTIVE
r3(Z);SHARED LOCK ON Z BY TRANSACTION [1, 3]
w1(Z);TRANSACTION1 IS BLOCKED AND THE OPERATION IS ADDDED TO WAITING TRANSACTIONSTRANSACTION1 IS BLOCKED
e1;TRANSACTION STATE BLOCKED AND THE OPERATION IS ADDED TO WAITING TRANSACTIONS
w3(Z);TRANSACTION3 IS ABORTED,CHECK AND RELEASE IF IT HOLDS ANY LOCKS
e3;TRANSACTION T3 IS ABORTED